# QA Automation Engineer - Praktyczne Przykłady Testów

## Overview
Ten dokument zawiera kompletne przykłady testów automatycznych dla aplikacji Movies, które mogą być wygenerowane z pomocą GitHub Copilot.

## 🧪 1. Page Object Model Framework

### BaseTest Class
```typescript
// Generated by Copilot
// Base test class z common setup dla wszystkich testów
import { test as base, expect, Page } from '@playwright/test';
import { MoviesPage } from '../pages/MoviesPage';
import { LoginPage } from '../pages/LoginPage';

type TestFixtures = {
  moviesPage: MoviesPage;
  loginPage: LoginPage;
};

export const test = base.extend<TestFixtures>({
  moviesPage: async ({ page }, use) => {
    const moviesPage = new MoviesPage(page);
    await use(moviesPage);
  },
  
  loginPage: async ({ page }, use) => {
    const loginPage = new LoginPage(page);
    await use(loginPage);
  }
});

export { expect };
```

### Movies Page Object
```typescript
// Generated by Copilot
// Page Object dla Movies page z wszystkimi selektorami i actions
export class MoviesPage {
  private page: Page;
  
  // Selektory
  private readonly addMovieButton = '[data-testid="add-movie-btn"]';
  private readonly movieCards = '[data-testid="movie-card"]';
  private readonly searchInput = '[data-testid="search-input"]';
  private readonly filterButton = '[data-testid="filter-btn"]';
  private readonly sortDropdown = '[data-testid="sort-dropdown"]';
  private readonly deleteConfirmModal = '[data-testid="delete-confirm-modal"]';
  
  constructor(page: Page) {
    this.page = page;
  }
  
  // Actions
  async navigateToMovies() {
    await this.page.goto('/movies');
    await this.page.waitForLoadState('networkidle');
  }
  
  async searchMovies(searchTerm: string) {
    await this.page.fill(this.searchInput, searchTerm);
    await this.page.keyboard.press('Enter');
    await this.page.waitForLoadState('networkidle');
  }
  
  async addNewMovie(movieData: CreateMovieData) {
    await this.page.click(this.addMovieButton);
    await this.fillMovieForm(movieData);
    await this.page.click('[data-testid="save-movie-btn"]');
    await this.page.waitForLoadState('networkidle');
  }
  
  async deleteMovie(movieTitle: string) {
    const movieCard = this.page.locator(this.movieCards).filter({ hasText: movieTitle });
    await movieCard.locator('[data-testid="delete-btn"]').click();
    await this.page.locator(this.deleteConfirmModal).locator('[data-testid="confirm-delete"]').click();
    await this.page.waitForLoadState('networkidle');
  }
  
  // Verifications
  async verifyMovieExists(movieTitle: string): Promise<boolean> {
    const movieCard = this.page.locator(this.movieCards).filter({ hasText: movieTitle });
    return await movieCard.isVisible();
  }
  
  async getMoviesCount(): Promise<number> {
    return await this.page.locator(this.movieCards).count();
  }
  
  private async fillMovieForm(movieData: CreateMovieData) {
    await this.page.fill('[data-testid="title-input"]', movieData.title);
    await this.page.fill('[data-testid="director-input"]', movieData.director);
    await this.page.fill('[data-testid="price-input"]', movieData.ticketPrice.toString());
    await this.page.fill('[data-testid="date-input"]', movieData.releaseDate);
  }
}

interface CreateMovieData {
  title: string;
  director: string;
  ticketPrice: number;
  releaseDate: string;
}
```

## 🧪 2. Data-Driven Testing

### Test Data Factory
```typescript
// Generated by Copilot
// Test data factory dla consistent test data generation
import { faker } from '@faker-js/faker';

export class MovieTestDataFactory {
  static createValidMovie(): CreateMovieData {
    return {
      title: faker.lorem.words(3),
      director: `${faker.person.firstName()} ${faker.person.lastName()}`,
      ticketPrice: Number(faker.commerce.price({ min: 10, max: 50 })),
      releaseDate: faker.date.past().toISOString().split('T')[0]
    };
  }
  
  static createInvalidMovie(): Partial<CreateMovieData> {
    return {
      title: '', // Invalid: empty title
      director: faker.person.firstName(),
      ticketPrice: -5, // Invalid: negative price
      releaseDate: faker.date.future().toISOString().split('T')[0] // Invalid: future date
    };
  }
  
  static createMoviesFromCsv(csvFilePath: string): CreateMovieData[] {
    // Implementation dla CSV data loading
    // Może być używane do data-driven testing
  }
  
  static createBulkMovies(count: number): CreateMovieData[] {
    return Array.from({ length: count }, () => this.createValidMovie());
  }
}
```

### Parametrized Tests
```typescript
// Generated by Copilot
// Parametrized tests dla różnych scenariuszy
import { test, expect } from './fixtures/baseTest';
import { MovieTestDataFactory } from './utils/MovieTestDataFactory';

const searchTestData = [
  { searchTerm: 'Godfather', expectedResults: 1 },
  { searchTerm: 'Tarantino', expectedResults: 2 },
  { searchTerm: 'NonExistent', expectedResults: 0 },
  { searchTerm: '', expectedResults: 10 } // All movies
];

searchTestData.forEach(({ searchTerm, expectedResults }) => {
  test(`Search movies with term: "${searchTerm}"`, async ({ moviesPage }) => {
    await moviesPage.navigateToMovies();
    await moviesPage.searchMovies(searchTerm);
    
    const resultsCount = await moviesPage.getMoviesCount();
    expect(resultsCount).toBe(expectedResults);
  });
});
```

## 🧪 3. API Testing z Playwright

### API Test Suite
```typescript
// Generated by Copilot
// API testing suite dla Movies endpoints
import { test, expect, APIRequestContext } from '@playwright/test';

test.describe('Movies API Tests', () => {
  let apiContext: APIRequestContext;
  
  test.beforeAll(async ({ playwright }) => {
    apiContext = await playwright.request.newContext({
      baseURL: 'http://localhost:5000/api',
      extraHTTPHeaders: {
        'Content-Type': 'application/json',
      }
    });
  });
  
  test.afterAll(async () => {
    await apiContext.dispose();
  });
  
  test('GET /movies - should return all movies', async () => {
    const response = await apiContext.get('/movies');
    
    expect(response.status()).toBe(200);
    
    const movies = await response.json();
    expect(Array.isArray(movies)).toBeTruthy();
    expect(movies.length).toBeGreaterThan(0);
    
    // Schema validation
    movies.forEach(movie => {
      expect(movie).toHaveProperty('id');
      expect(movie).toHaveProperty('title');
      expect(movie).toHaveProperty('director');
      expect(movie).toHaveProperty('ticketPrice');
      expect(movie).toHaveProperty('releaseDate');
    });
  });
  
  test('POST /movies - should create new movie', async () => {
    const newMovie = MovieTestDataFactory.createValidMovie();
    
    const response = await apiContext.post('/movies', {
      data: {
        id: crypto.randomUUID(),
        ...newMovie
      }
    });
    
    expect(response.status()).toBe(200);
    
    // Verify movie was created
    const getResponse = await apiContext.get('/movies');
    const movies = await getResponse.json();
    const createdMovie = movies.find(m => m.title === newMovie.title);
    expect(createdMovie).toBeDefined();
  });
  
  test('PUT /movies/{id} - should update existing movie', async () => {
    // First create a movie
    const movie = MovieTestDataFactory.createValidMovie();
    const createResponse = await apiContext.post('/movies', {
      data: { id: crypto.randomUUID(), ...movie }
    });
    
    // Get the created movie ID
    const movies = await (await apiContext.get('/movies')).json();
    const createdMovie = movies.find(m => m.title === movie.title);
    
    // Update the movie
    const updatedData = { ...movie, title: 'Updated Title' };
    const updateResponse = await apiContext.put(`/movies/${createdMovie.id}`, {
      data: updatedData
    });
    
    expect(updateResponse.status()).toBe(200);
    
    // Verify update
    const verifyResponse = await apiContext.get(`/movies/${createdMovie.id}`);
    const updatedMovie = await verifyResponse.json();
    expect(updatedMovie.title).toBe('Updated Title');
  });
  
  test('DELETE /movies/{id} - should delete existing movie', async () => {
    // Create and then delete
    const movie = MovieTestDataFactory.createValidMovie();
    await apiContext.post('/movies', {
      data: { id: crypto.randomUUID(), ...movie }
    });
    
    const movies = await (await apiContext.get('/movies')).json();
    const movieToDelete = movies.find(m => m.title === movie.title);
    
    const deleteResponse = await apiContext.delete(`/movies/${movieToDelete.id}`);
    expect(deleteResponse.status()).toBe(200);
    
    // Verify deletion
    const verifyResponse = await apiContext.get(`/movies/${movieToDelete.id}`);
    expect(verifyResponse.status()).toBe(404);
  });
});
```

## 🧪 4. Visual Regression Testing

### Visual Tests Setup
```typescript
// Generated by Copilot
// Visual regression tests dla UI components
import { test, expect } from '@playwright/test';

test.describe('Visual Regression Tests', () => {
  test('Movies page visual consistency', async ({ page }) => {
    await page.goto('/movies');
    await page.waitForLoadState('networkidle');
    
    // Hide dynamic elements
    await page.addStyleTag({
      content: `
        [data-testid="timestamp"],
        [data-testid="loading-spinner"] {
          visibility: hidden !important;
        }
      `
    });
    
    await expect(page).toHaveScreenshot('movies-page.png');
  });
  
  test('Movie card component visual test', async ({ page }) => {
    await page.goto('/movies');
    
    const firstMovieCard = page.locator('[data-testid="movie-card"]').first();
    await expect(firstMovieCard).toHaveScreenshot('movie-card.png');
  });
  
  test('Responsive design - mobile view', async ({ page }) => {
    await page.setViewportSize({ width: 375, height: 667 });
    await page.goto('/movies');
    
    await expect(page).toHaveScreenshot('movies-page-mobile.png');
  });
});
```

## 🧪 5. Performance Testing

### Performance Test Setup
```javascript
// Generated by Copilot
// Performance testing z K6
import http from 'k6/http';
import { check, sleep } from 'k6';
import { Rate } from 'k6/metrics';

export const errorRate = new Rate('errors');

export const options = {
  stages: [
    { duration: '2m', target: 100 }, // Ramp up to 100 users
    { duration: '5m', target: 100 }, // Stay at 100 users
    { duration: '2m', target: 200 }, // Ramp up to 200 users
    { duration: '5m', target: 200 }, // Stay at 200 users
    { duration: '2m', target: 0 },   // Ramp down to 0 users
  ],
  thresholds: {
    http_req_duration: ['p(99)<1500'], // 99% of requests must complete below 1.5s
    errors: ['rate<0.1'], // Error rate must be below 10%
  },
};

export default function () {
  // Test GET /movies endpoint
  const response = http.get('http://localhost:5000/api/movies');
  
  check(response, {
    'status is 200': (r) => r.status === 200,
    'response time < 500ms': (r) => r.timings.duration < 500,
  }) || errorRate.add(1);
  
  sleep(1);
}
```

## 🧪 6. Accessibility Testing

### Accessibility Test Suite
```typescript
// Generated by Copilot
// Accessibility testing z axe-core
import { test, expect } from '@playwright/test';
import AxeBuilder from '@axe-core/playwright';

test.describe('Accessibility Tests', () => {
  test('Movies page should not have accessibility violations', async ({ page }) => {
    await page.goto('/movies');
    
    const accessibilityScanResults = await new AxeBuilder({ page })
      .withTags(['wcag2a', 'wcag2aa', 'wcag21aa'])
      .analyze();
    
    expect(accessibilityScanResults.violations).toEqual([]);
  });
  
  test('Keyboard navigation test', async ({ page }) => {
    await page.goto('/movies');
    
    // Test tab navigation
    await page.keyboard.press('Tab');
    const firstFocusable = await page.evaluate(() => document.activeElement?.tagName);
    expect(['INPUT', 'BUTTON', 'A']).toContain(firstFocusable);
    
    // Test Enter key on buttons
    await page.locator('[data-testid="add-movie-btn"]').focus();
    await page.keyboard.press('Enter');
    
    // Verify modal opened
    await expect(page.locator('[data-testid="movie-form-modal"]')).toBeVisible();
  });
  
  test('Screen reader announcements', async ({ page }) => {
    await page.goto('/movies');
    
    // Check for proper ARIA labels
    const searchInput = page.locator('[data-testid="search-input"]');
    await expect(searchInput).toHaveAttribute('aria-label', 'Search movies');
    
    // Check for live regions
    await searchInput.fill('Godfather');
    const resultsRegion = page.locator('[aria-live="polite"]');
    await expect(resultsRegion).toBeVisible();
  });
});
```

## 🧪 7. Cross-Browser Testing

### Cross-Browser Test Configuration
```typescript
// Generated by Copilot
// playwright.config.ts dla cross-browser testing
import { defineConfig, devices } from '@playwright/test';

export default defineConfig({
  testDir: './tests',
  fullyParallel: true,
  forbidOnly: !!process.env.CI,
  retries: process.env.CI ? 2 : 0,
  workers: process.env.CI ? 1 : undefined,
  reporter: 'html',
  
  projects: [
    {
      name: 'chromium',
      use: { ...devices['Desktop Chrome'] },
    },
    {
      name: 'firefox',
      use: { ...devices['Desktop Firefox'] },
    },
    {
      name: 'webkit',
      use: { ...devices['Desktop Safari'] },
    },
    {
      name: 'Mobile Chrome',
      use: { ...devices['Pixel 5'] },
    },
    {
      name: 'Mobile Safari',
      use: { ...devices['iPhone 12'] },
    },
  ],
  
  webServer: {
    command: 'npm run dev',
    url: 'http://localhost:3000',
    reuseExistingServer: !process.env.CI,
  },
});
```

## 🧪 8. CI/CD Integration

### GitHub Actions dla Automated Testing
```yaml
# Generated by Copilot
# .github/workflows/qa-automation.yml
name: QA Automation Tests

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  api-tests:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
          
      - name: Install dependencies
        run: npm ci
        
      - name: Start Movies API
        run: |
          cd ../dotnet-movies-api
          dotnet run &
          sleep 30
          
      - name: Run API Tests
        run: npx playwright test api/
        
  e2e-tests:
    runs-on: ubuntu-latest
    needs: api-tests
    strategy:
      matrix:
        browser: [chromium, firefox, webkit]
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
          
      - name: Install dependencies
        run: npm ci
        
      - name: Install Playwright Browsers
        run: npx playwright install ${{ matrix.browser }}
        
      - name: Run E2E Tests
        run: npx playwright test --project=${{ matrix.browser }}
        
      - name: Upload test results
        uses: actions/upload-artifact@v3
        if: failure()
        with:
          name: test-results-${{ matrix.browser }}
          path: test-results/
          
  performance-tests:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Run K6 Performance Tests
        uses: grafana/k6-action@v0.2.0
        with:
          filename: tests/performance/load-test.js
```

## 📋 Test Execution Commands

### Local Testing Commands
```powershell
# Generated by Copilot
# Commands dla local test execution

# Run all tests
npm run test

# Run specific test types
npm run test:unit
npm run test:integration  
npm run test:e2e
npm run test:api
npm run test:visual
npm run test:performance
npm run test:accessibility

# Run tests in specific browser
npx playwright test --project=chromium
npx playwright test --project=firefox

# Run tests with UI mode
npx playwright test --ui

# Generate test report
npx playwright show-report

# Debug specific test
npx playwright test --debug tests/movies.spec.ts
```

## 📊 Test Reporting

### Allure Report Integration
```typescript
// Generated by Copilot
// Allure reporting setup dla comprehensive test reports
import { test as base } from '@playwright/test';
import { allure } from 'allure-playwright';

export const test = base.extend({
  page: async ({ page }, use, testInfo) => {
    // Add test metadata
    await allure.epic('Movies Application');
    await allure.feature('CRUD Operations');
    await allure.story(testInfo.title);
    
    await use(page);
  }
});

// Usage in tests
test('Create new movie', async ({ page }) => {
  await allure.step('Navigate to movies page', async () => {
    await page.goto('/movies');
  });
  
  await allure.step('Click add movie button', async () => {
    await page.click('[data-testid="add-movie-btn"]');
  });
  
  await allure.step('Fill movie form', async () => {
    await page.fill('[data-testid="title-input"]', 'Test Movie');
    // ... more form filling
  });
});
```

Te przykłady pokazują kompletne podejście do automatyzacji testów dla aplikacji Movies, które może być zrealizowane przez QA automation engineer z pomocą GitHub Copilot. Każdy przykład zawiera praktyczne implementacje, które można dostosować do specyficznych wymagań projektu.
