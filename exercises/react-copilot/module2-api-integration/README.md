# Module 2: API Integration and Data Management

## Cel modułu
Nauka integracji z Movies API oraz zarządzania danymi w aplikacji React z wykorzystaniem GitHub Copilot.

## User Stories i Ćwiczenia

### User Story 1: Service do komunikacji z API
**Jako deweloper, chcę mieć scentralizowany sposób komunikacji z Movies API.**

#### Exercise (Beginner):
1. Stwórz `MovieService` class z GitHub Copilot
2. Implementuj wszystkie operacje CRUD
3. Dodaj proper error handling i response typing

**Prompt dla Copilot:**
```typescript
// Generated by Copilot
// Service class do komunikacji z Movies API
// Powinien używać axios do HTTP requests
// Powinien zawierać metody: getAllMovies, getMovieById, createMovie, updateMovie, deleteMovie
// Każda metoda powinna zwracać Promise z odpowiednim typem
// Base URL: http://localhost:5000/api
```

#### Expected Implementation:
```typescript
// Generated by Copilot
import axios from 'axios';

class MovieService {
  private readonly baseUrl = 'http://localhost:5000/api';
  
  async getAllMovies(): Promise<Movie[]> {
    // Implementacja
  }
  
  // Pozostałe metody...
}

export const movieService = new MovieService();
```

### User Story 2: Custom hook do pobierania danych
**Jako deweloper, chcę mieć reusable hook do pobierania danych z API.**

#### Exercise (Intermediate):
1. Stwórz hook `useMovieData` z GitHub Copilot
2. Implementuj loading states, error handling i retry logic
3. Dodaj cache mechanism

**Prompt dla Copilot:**
```typescript
// Generated by Copilot
// Custom hook do pobierania danych filmów z API
// Powinien zwracać: data, loading, error, refetch
// Powinien automatycznie pobierać dane przy mount
// Powinien cachować wyniki na 5 minut
// Powinien obsłużyć retry w przypadku błędu
```

### User Story 3: Formularz z API integration
**Jako administrator, chcę móc dodawać nowe filmy przez formularz połączony z API.**

#### Exercise (Advanced):
1. Rozszerz poprzedni `AddMovieForm` o integrację z API
2. Dodaj loading states i success/error notifications
3. Implementuj optimistic updates

**Prompt dla Copilot:**
```typescript
// Generated by Copilot
// Formularz React do dodawania filmu z integracją API
// Po submicie powinien wywołać movieService.createMovie
// Powinien pokazać loading spinner podczas zapisu
// Powinien pokazać toast notification po sukcesie lub błędzie
// Powinien użyć optimistic update - dodać film do listy od razu
// Powinien obsłużyć rollback w przypadku błędu API
```

### User Story 4: Hook do operacji CRUD
**Jako deweloper, chcę mieć kompletny hook do wszystkich operacji na filmach.**

#### Exercise (Advanced):
1. Stwórz `useMovieOperations` hook z GitHub Copilot
2. Implementuj wszystkie operacje CRUD z proper state management
3. Dodaj optimistic updates i error recovery

**Prompt dla Copilot:**
```typescript
// Generated by Copilot
// Comprehensive hook do operacji CRUD na filmach
// Powinien zarządzać listą filmów w lokalnym state
// Powinien zawierać metody: addMovie, updateMovie, deleteMovie, refreshMovies
// Każda operacja powinna używać optimistic updates
// Powinien obsłużyć rollback w przypadku błędów
// Powinien zwracać loading state dla każdej operacji osobno
```

### User Story 5: Error boundary dla API errors
**Jako użytkownik, chcę widzieć przyjazne komunikaty błędów gdy API nie działa.**

#### Exercise (Intermediate):
1. Stwórz `ApiErrorBoundary` component z GitHub Copilot
2. Implementuj różne typy error displays
3. Dodaj retry functionality

**Prompt dla Copilot:**
```typescript
// Generated by Copilot
// React Error Boundary do obsługi błędów API
// Powinien wyświetlać różne komunikaty w zależności od typu błędu
// 404 - "Film nie został znaleziony"
// 500 - "Problem z serwerem, spróbuj później"
// Network error - "Sprawdź połączenie internetowe"
// Powinien zawierać przycisk "Spróbuj ponownie"
```

## Dodatkowe ćwiczenia

### Exercise 6: Axios interceptors (Advanced)
Stwórz interceptors do automatycznego dodawania headers i obsługi błędów globalnie.

### Exercise 7: Offline support (Expert)
Implementuj basic offline support z localStorage cache.

### Exercise 8: Request cancellation (Advanced)
Dodaj możliwość anulowania requestów przy unmount componentu.

## API Endpoints Reference

### GET /api/movies
```typescript
// Response
Movie[]
```

### GET /api/movies/{id}
```typescript
// Response
Movie | 404 Not Found
```

### POST /api/movies
```typescript
// Request Body
CreateMovieRequest

// Response
200 OK | 409 Conflict
```

### PUT /api/movies/{id}
```typescript
// Request Body
UpdateMovieRequest

// Response
200 OK | 404 Not Found
```

### DELETE /api/movies/{id}
```typescript
// Response
200 OK | 404 Not Found
```

## Error Handling Best Practices
1. **Zawsze obsługuj network errors**
2. **Używaj typu response z API**
3. **Implementuj retry logic dla transient errors**
4. **Pokazuj user-friendly error messages**
5. **Loguj błędy dla debugowania**

## Testing API Integration
```typescript
// Generated by Copilot
// Mock setup dla testów jednostkowych
// Użyj jest.mock() dla movieService
// Testuj wszystkie success i error scenariusze
```

## Oczekiwane rezultaty
Po ukończeniu tego modułu powinieneś umieć:
- Integrować React components z REST API
- Implementować proper error handling i loading states
- Tworzyć reusable hooks do operacji API
- Używać optimistic updates dla lepszego UX
- Obsługiwać różne scenariusze błędów
